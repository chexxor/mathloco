---
import type { DiscordChannel } from '../types/discord';
import { getDiscordSummary } from '../lib/discord';

const data = await getDiscordSummary();
---

<div class="space-y-6">
  {data.channels.length > 0 ? (
    <div>
      <div class="space-y-6">
        {data.channels.map((channel: DiscordChannel) => {
          const channelData = data.messages.find(msg => msg.channelId === channel.id);
          return (
            <div class="bg-gray-50 rounded-lg overflow-hidden border border-gray-200">
              <div class="px-4 py-3 bg-gray-100 border-b border-gray-200">
                <span class="font-medium text-gray-800">#{channel.name}</span>
              </div>
              {channelData?.summary && (
                <div class="p-6">
                  {channelData.timeRange && (
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">
                      Channel Summary: {channelData.timeRange}
                    </h3>
                  )}
                  <div class="prose prose-blue max-w-none" set:html={channelData.summary} />
                </div>
              )}
            </div>
          );
        })}
      </div>
    </div>
  ) : (
    <div class="bg-blue-50 rounded-lg p-8 text-center">
      <p class="text-gray-600">No channels available. Please check back later.</p>
    </div>
  )}
</div>
